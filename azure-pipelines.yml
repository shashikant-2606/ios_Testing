trigger:
  - main

pool:
  vmImage: 'macOS-latest'

stages:
  - stage: emulator
    jobs:
      - job: test
        steps:
          - task: NodeTool@0
            inputs:
              versionSource: 'spec'
              versionSpec: '18.17.1'

          - task: JavaToolInstaller@0
            inputs:
              versionSpec: '11'
              jdkArchitectureOption: 'x64'
              jdkSourceOption: 'PreInstalled'


          - script: |
              xcrun simctl list
              xcrun simctl create iPhone1 com.apple.CoreSimulator.SimDeviceType.iPhone-11 com.apple.CoreSimulator.SimRuntime.iOS-16-2 
              xcrun simctl boot iphone1
              npm install -g appium
              appium --version
              appium driver install xcuitest
              appium plugin install --source npm appium-device-farm
              appium --address 0.0.0.0 --port 4723 --log-level debug --use-plugins appium-xcuitest-driver &
              
              
  
